---
import RootLayout from '@/layouts/RootLayout.astro';
import { getCollection } from 'astro:content';

const logs = await getCollection('logs');
---

<RootLayout title="5. Content">
  <h1>Captain's Logs</h1>
  <p
    >Data fetched from <code>src/content/logs</code> using Content Collections.
    Fully Type-safe!</p
  >

  <div class="logs">
    {logs.map(log => (
      <div class="log-entry">
        <h3>{log.data.title}</h3>
        <p class="meta">
          {log.data.date.toLocaleDateString()} | Officer: {log.data.officer}
        </p>
        <div class="tags">
          {log.data.tags.map(tag => <span class="tag">#{tag}</span>)}
        </div>
        <!-- 
          Note: In Content Layer with glob loader, .body isn't directly available as a raw string 
          the way legacy collections worked, but let's check. 
          Actually for Markdown, we usually use render(log).
        -->
        {/* The HTML comment ^ on top of this one is rendered in the output HTML
        whereas this one is not */}
        <p class="body">
           (Content rendering would go here, traditionally <code>log.body</code> or <code>&lt;Content /&gt;</code>)
        </p>
      </div>
    ))}
  </div>

  <div class="tip">
    <p
      ><strong>Try this:</strong> Edit
      <code>src/content/logs/first-contact.md</code> and change
      <code>date</code> to a string "yesterday". The build will fail instantly!</p
    >
  </div>
</RootLayout>

<style>
  .log-entry {
    background: var(--color-card);
    border: 1px solid rgba(255, 255, 255, 0.1);
    padding: 1.5rem;
    border-radius: 8px;
    margin-bottom: 1rem;
    margin-top: 2rem;
  }
  .meta {
    color: #888;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
  }
  .tags {
    display: flex;
    gap: 0.5rem;
    margin: 0.5rem 0;
  }
  .tag {
    background: rgba(56, 189, 248, 0.2);
    color: var(--accent);
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-size: 0.8rem;
  }
  .tip {
    margin-top: 3rem;
    border-top: 1px solid #333;
    padding-top: 1rem;
    color: #888;
    font-style: italic;
  }
</style>
